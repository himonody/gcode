
```
┌──────────────────────────────────────────────┐
│                  前端层（Client）             │
│        Web / App / PC / SDK / Partner         │
└──────────────────────────────────────────────┘
                     │
                     │  North-South
                     ▼
┌──────────────────────────────────────────────┐
│            对外网关层（Edge Gateway）          │
│              APISIX / Kong / Nginx           │
│  - TLS / HTTPS                                │
│  - 鉴权 / 限流 / WAF                          │
│  - API 路由 / 版本管理                        │
│  - gRPC / HTTP 接入                           │
└──────────────────────────────────────────────┘
                     │
                     │  业务入口
                     ▼
┌──────────────────────────────────────────────┐
│        应用层网关（Application / BFF）        │
│            Hertz / Gin / Connect              │
│  - 业务接口聚合                               │
│  - 参数裁剪 / DTO 适配                        │
│  - 用户态鉴权 / Session                      │
│  - 多端适配（Web / App）                      │
│  - 调用下游 gRPC 服务                         │
└──────────────────────────────────────────────┘
                     │
                     │  East-West（开始进入 Mesh）
                     ▼
┌──────────────────────────────────────────────┐
│           服务层（Service Layer）              │
│                Istio Service Mesh             │
│        （Envoy Sidecar 自动注入）              │
│                                              │
│  ┌────────────┐   ┌────────────┐   ┌────────┐│
│  │  微服务 A   │⇄⇄│  微服务 B   │⇄⇄│ 服务 C ││
│  │  gRPC       │   │  gRPC       │   │ gRPC   ││
│  │  + Envoy    │   │  + Envoy    │   │ +Envoy ││
│  └────────────┘   └────────────┘   └────────┘│
│                                              │
│  - 服务发现 / 负载均衡                        │
│  - mTLS                                      │
│  - 熔断 / 重试 / 超时                        │
│  - 灰度 / 流量治理                            │
│  - 全链路可观测（OTel）                      │
└──────────────────────────────────────────────┘
```
```
┌──────────────────────────────────────────────┐
│                  前端层（Client）             │
│        Web / App / PC / SDK / Partner         │
└──────────────────────────────────────────────┘
                     │
                     │  North-South
                     ▼
┌──────────────────────────────────────────────┐
│            对外网关层（Edge Gateway）          │
│                APISIX / Kong                  │
│  - TLS / HTTPS                                │
│  - 鉴权 / 限流 / WAF                          │
│  - API 路由 / 版本管理                        │
│  - HTTP / gRPC 接入                           │
└──────────────────────────────────────────────┘
                     │
                     │  业务入口
                     ▼
┌──────────────────────────────────────────────┐
│     应用层网关（Application / BFF 层）        │
│        Hertz / Gin / Kratos HTTP              │
│  - 业务接口聚合                               │
│  - DTO / VO 适配                              │
│  - 用户态鉴权 / Session                      │
│  - 编排多个下游 Kratos 服务                   │
└──────────────────────────────────────────────┘
                     │
                     │  East-West（进入 Mesh）
                     ▼
┌──────────────────────────────────────────────┐
│           服务层（Service Layer）              │
│        Kratos 微服务/go-zero微服务 +           │
│            gRPC + Protobuf                   │
│        （Istio Service Mesh 管理）             │
│                                              │
│  ┌────────────┐   ┌────────────┐   ┌────────┐│
│  │ Kratos A    │⇄⇄│ Kratos B    │⇄⇄│ Kratos C││
│  │ gRPC        │   │ gRPC        │   │ gRPC   ││
│  │ + Envoy     │   │ + Envoy     │   │ +Envoy ││
│  └────────────┘   └────────────┘   └────────┘│
│                                              │
│  - 服务发现 / LB（Istio）                     │
│  - mTLS（Istio）                              │
│  - 熔断 / 重试 / 超时（Istio）                │
│  - Trace / Metrics（OTel）                    │
└──────────────────────────────────────────────┘

```

```

┌────────────────────────────────────────────────────────────────────┐
│                         前端层（Client）                           │
│        Web / App / PC / SDK / Partner                               │
│                                                                    │
│   - HTTP / JSON                                                     │
│   - 自动生成 SDK（TS / Mobile）                                     │
└────────────────────────────────────────────────────────────────────┘
                                │
                                │  North-South（外部流量）
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                  对外网关层（Edge Gateway）                         │
│              APISIX / Kong / NGINX                                  │
│                                                                    │
│   - TLS / HTTPS                                                     │
│   - WAF / DDoS / IP 黑白名单                                        │
│   - 全局鉴权 / 限流 / 配额                                          │
│   - API 路由 / 版本管理                                            │
│   - HTTP / gRPC 透明转发                                           │
│                                                                    │
│   ⚠️ 只处理 North-South，不参与服务间通信                          │
└────────────────────────────────────────────────────────────────────┘
                                │
                                │  业务入口（尚未进入 Mesh）
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│            应用层网关（RPC-BFF / Application Layer）               │
│                         Connect Server                              │
│                    （基于同一份 Proto）                             │
│                                                                    │
│   - HTTP + JSON / Protobuf                                          │
│   - 强类型 RPC API（不是 REST）                                    │
│   - 接口聚合 / 编排                                                │
│   - DTO / VO 适配                                                  │
│   - 轻量用户态鉴权（Token / Session）                              │
│                                                                    │
│   ❌ 不做：                                                         │
│      - 服务发现                                                    │
│      - 负载均衡                                                    │
│      - 熔断 / 限流                                                 │
│      - mTLS                                                        │
└────────────────────────────────────────────────────────────────────┘
                                │
                                │  East-West（进入 Mesh）
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                  服务层（Service Layer）                           │
│            Kratos + gRPC + Protobuf                                 │
│                    Istio Service Mesh                               │
│            （Envoy Sidecar 自动注入）                               │
│                                                                    │
│   ┌────────────┐    ┌────────────┐    ┌────────────┐              │
│   │ Kratos A   │⇄⇄⇄│ Kratos B   │⇄⇄⇄│ Kratos C   │              │
│   │ gRPC       │    │ gRPC       │    │ gRPC       │              │
│   │ + Envoy    │    │ + Envoy    │    │ + Envoy    │              │
│   └────────────┘    └────────────┘    └────────────┘              │
│                                                                    │
│   - 服务发现 / 负载均衡（Istio）                                   │
│   - mTLS（服务间双向加密）                                         │
│   - 熔断 / 重试 / 超时                                             │
│   - 灰度发布 / 流量治理                                            │
│   - 全链路可观测（OpenTelemetry）                                  │
└────────────────────────────────────────────────────────────────────┘

```